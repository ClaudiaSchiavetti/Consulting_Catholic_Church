# Catholic Church Statistics – Interactive Shiny Applications

This repository contains a set of interactive Shiny applications developed to visualise and explore administrative data from the *Annuarium Statisticum Ecclesiae* (2022 edition).  
The project was carried out within the Statistical Consulting module of the Master’s program in Statistics and Data Science at LMU Munich, in collaboration with the Faculty of Catholic Theology.

The applications are designed for a broad audience, including Church practitioners, researchers, and journalists, and aim to provide transparent, reproducible, and user-friendly access to Church statistics.

## Repository Structure

The repository is organised into four main components:

- **map/** – Main geographical Shiny application  
  Interactive world maps, data explorer, and time-series visualisations at country and macroregion level.

- **ispr_men/** – ISPR Shiny application (men)  
  Visualisation of Institutes and Societies of Pontifical Right for men.

- **ispr_women/** – ISPR Shiny application (women)  
  Visualisation of Institutes and Societies of Pontifical Right for women.

- **data_preprocessing/** – Data preparation pipeline  
  Scripts and auxiliary files used to clean, harmonise, and merge the raw input tables into analysis-ready datasets.

Additional files in the root directory document the exploratory analyses and project outputs (see below).

## Application Folder Contents

Each Shiny application folder (**map/**, **ispr_men/**, **ispr_women/**) follows the same internal structure:

- **app.R** (or `map.R`)  
  Complete Shiny application source code, including user interface and server logic.

- **final_geo_table.csv**  
  Cleaned and harmonised dataset used by the application.  
  This dataset is generated by the preprocessing pipeline and serves as the common input for both the Shiny applications and the exploratory cluster analysis.

- **variable_abbreviations.csv**  
  Lookup table mapping full variable names from the *Annuarium* to shortened labels used in dashboards and exported outputs.

- **Dockerfile**  
  Defines a self-contained software environment in which the application can be built and run.  
  It specifies the required R version, R packages, and system dependencies, ensuring consistent behaviour across machines and operating systems.

- **docker-compose.yml**  
  Simplifies launching the application using Docker by defining container settings such as port mappings and runtime options.  
  This allows the application to be started with a single command.

## Data Preprocessing

The **data_preprocessing/** folder contains:

- **data_script.R**  
  Main R script implementing the full data cleaning, harmonisation, and merging pipeline described in the report.  
  The script takes as input OCR-extracted tables and scans of the *Annuarium Statisticum Ecclesiae* (2022 edition), which were provided to the authors through private access to an internal repository curated by Felicitas Hörl.  
  Due to copyright and access restrictions, these raw input files cannot be redistributed publicly. Users wishing to reproduce the pipeline must supply the corresponding source tables obtained through legitimate access channels.

- **data_overview.xlsx**  
  Overview of the original tables and variables used in the preprocessing stage.

- **rownames_adjusted.xlsx**  
  Auxiliary file containing harmonised country names used to reconcile the *Annuarium* data with geospatial references.

## Exploratory Analysis

- **cluster_proposal.R**  
  R script implementing the exploratory cluster analysis discussed in the report, including variable selection, transformations, distance computation, clustering procedures, and diagnostic checks.  
  The script uses **final_geo_table.csv** as its input dataset.

## Additional Materials

- **presentation.pdf** – Slides used for the final project presentation.  
- **report.pdf** – Final consulting report.  
- **Consulting_Catholic_Church.Rproj** – RStudio project file for reproducibility and ease of use.

## Reproducibility Notes

All code in this repository is fully documented, modular, and written in English.  
Absolute paths are avoided, random seeds are set where applicable, and scripts are designed to be executed without manual intervention once the required input data are available.

Users are encouraged to consult the README and in-code comments before running the applications or analyses.
